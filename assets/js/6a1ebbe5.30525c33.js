"use strict";(self.webpackChunktracetest_docs=self.webpackChunktracetest_docs||[]).push([[318],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=a.createContext({}),c=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(i.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||l;return n?a.createElement(g,o(o({ref:t},p),{},{components:n})):a.createElement(g,o({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[u]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<l;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},96743:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const l={},o="Run Tracetest Locally",s={unversionedId:"run-locally",id:"run-locally",title:"Run Tracetest Locally",description:"Tracetest depends on a postgres database and a trace store backend (Jaeger or Tempo). The frontend requires node and npm and the backend requires the go tooling.",source:"@site/docs/run-locally.md",sourceDirName:".",slug:"/run-locally",permalink:"/run-locally",draft:!1,editUrl:"https://github.com/kubeshop/tracetest/blob/main/docs/docs/run-locally.md",tags:[],version:"current",frontMatter:{}},i={},c=[{value:"<strong>Run on Local Kubernetes</strong>",id:"run-on-local-kubernetes",level:2},{value:"<strong>Installing Jaeger</strong>",id:"installing-jaeger",level:3},{value:"<strong>Install Tracetest</strong>",id:"install-tracetest",level:3},{value:"<strong>Run a Development Build</strong>",id:"run-a-development-build",level:2}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"run-tracetest-locally"},"Run Tracetest Locally"),(0,r.kt)("p",null,"Tracetest depends on a postgres database and a trace store backend (Jaeger or Tempo). The frontend requires node and npm and the backend requires the go tooling."),(0,r.kt)("h2",{id:"run-on-local-kubernetes"},(0,r.kt)("strong",{parentName:"h2"},"Run on Local Kubernetes")),(0,r.kt)("p",null,"Tracetest and its dependencies can be installed in a local Kubernetes cluster (microk8s, minikube, Kubernetes for Docker Desktop, etc).\nFollowing the ",(0,r.kt)("a",{parentName:"p",href:"./getting-started/installation"},"install steps")," will install a running instance of Tracetest and Postgres. Installing Jaeger is the easiest way to get a trace store backend."),(0,r.kt)("p",null,"The Tracetest install can be exposed with a ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadBalancer"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"NodePort")," or any similar mechanism. It can also be kept internally, only expose the Jaeger and postgres port,\nand use them to run local development builds. This is useful to quickly test changes on both the front and back end."),(0,r.kt)("h3",{id:"installing-jaeger"},(0,r.kt)("strong",{parentName:"h3"},"Installing Jaeger")),(0,r.kt)("p",null,"Before installing Tracetest, we need to setup the ",(0,r.kt)("a",{parentName:"p",href:"https://www.jaegertracing.io/docs/1.32/operator/"},"Jaeger operator"),", which in turn has a dependency on ",(0,r.kt)("a",{parentName:"p",href:"https://cert-manager.io/"},"cert-mnanager"),".\ncert-manager has different ",(0,r.kt)("a",{parentName:"p",href:"https://cert-manager.io/docs/installation/"},"install options"),". The simplest way to do this is to use a static install:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.8.0/cert-manager.yaml\n")),(0,r.kt)("p",null,"Once the pods in ",(0,r.kt)("inlineCode",{parentName:"p"},"cert-manager")," namespace are running, we can install the Jaeger operator:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kubectl create namespace observability\nkubectl create -f https://github.com/jaegertracing/jaeger-operator/releases/download/v1.32.0/jaeger-operator.yaml -n observability\n")),(0,r.kt)("p",null,"Now, create an ",(0,r.kt)("inlineCode",{parentName:"p"},"AllInOne")," jaeger instance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cat <<EOF | kubectl create -f -\napiVersion: jaegertracing.io/v1\nkind: Jaeger\nmetadata:\n  name: jaeger\nEOF\n")),(0,r.kt)("h3",{id:"install-tracetest"},(0,r.kt)("strong",{parentName:"h3"},"Install Tracetest")),(0,r.kt)("p",null,"Follow the ",(0,r.kt)("a",{parentName:"p",href:"./getting-started/installation"},"install steps"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'helm repo add kubeshop https://kubeshop.github.io/helm-charts\nhelm repo update\n\nhelm install tracetest kubeshop/tracetest \\\n  --set telemetry.dataStores.jaeger.jaeger.endpoint="jaeger-query:16685" \\ # update this value to point to your jaeger install\n  --set telemetry.exporters.collector.exporter.collector.endpoint="otel-collector:4317" \\ # update this value to point to your collector install\n  --set server.telemetry.dataStore="jaeger"\n')),(0,r.kt)("p",null,"You can now expose the Tracetest service using a ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadBalancer"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"NodePort")," or even a simple ",(0,r.kt)("inlineCode",{parentName:"p"},"port-forward"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kubectl port-forward svc/tracetest 11633:11633\n")),(0,r.kt)("p",null,"Now Tracetest is available at ","[http://localhost:11633]"),(0,r.kt)("h2",{id:"run-a-development-build"},(0,r.kt)("strong",{parentName:"h2"},"Run a Development Build")),(0,r.kt)("p",null,"You can build and run Tracetest locally using Docker compose. The project provides a Docker compose file and a Makefile with targets to generate the required image."),(0,r.kt)("p",null,"You will need ",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/compose/install/"},"Docker Compose")," installed, as well as ",(0,r.kt)("a",{parentName:"p",href:"https://goreleaser.com/install/"},"GoReleaser-Pro"),".\nNote that while the ",(0,r.kt)("inlineCode",{parentName:"p"},"pro")," version is required, no licencing is needed for local builds."),(0,r.kt)("p",null,"You can build each part of the system separatedly:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"make build-web\nmake build-cli\nmake build-server\n")),(0,r.kt)("p",null,"You can build and tag the docker image, implicitly building web, cli and server:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"make build-docker\n")),(0,r.kt)("p",null,"This will build a new image, tagged ",(0,r.kt)("inlineCode",{parentName:"p"},"kubeshop/tracetest:latest")),(0,r.kt)("p",null,"To build and run tracetest locally:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"make run\n")),(0,r.kt)("p",null,"Once the app is finished loading all the services, you can access your local tracetest at ","[http://localhost:11633]","."))}d.isMDXComponent=!0}}]);