"use strict";(self.webpackChunktracetest_docs=self.webpackChunktracetest_docs||[]).push([[5595],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>f});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),l=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(a),d=r,f=u["".concat(s,".").concat(d)]||u[d]||m[d]||i;return a?n.createElement(f,o(o({ref:t},p),{},{components:a})):n.createElement(f,o({ref:t},p))}));function f(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[u]="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},53597:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const i={},o="Elastic APM",c={unversionedId:"configuration/connecting-to-data-stores/elasticapm",id:"configuration/connecting-to-data-stores/elasticapm",title:"Elastic APM",description:"Tracetest fetches traces from Elasticsearch's default port 9200.",source:"@site/docs/configuration/connecting-to-data-stores/elasticapm.md",sourceDirName:"configuration/connecting-to-data-stores",slug:"/configuration/connecting-to-data-stores/elasticapm",permalink:"/configuration/connecting-to-data-stores/elasticapm",draft:!1,editUrl:"https://github.com/kubeshop/tracetest/blob/main/docs/docs/configuration/connecting-to-data-stores/elasticapm.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Dynatrace",permalink:"/configuration/connecting-to-data-stores/dynatrace"},next:{title:"Tempo",permalink:"/configuration/connecting-to-data-stores/tempo"}},s={},l=[{value:"Configure Tracetest to Use Elastic APM as a Trace Data Store",id:"configure-tracetest-to-use-elastic-apm-as-a-trace-data-store",level:2},{value:"Connect Tracetest to Elastic with the Web UI",id:"connect-tracetest-to-elastic-with-the-web-ui",level:2},{value:"Connect Tracetest to Elastic with the CLI",id:"connect-tracetest-to-elastic-with-the-cli",level:2}],p={toc:l},u="wrapper";function m(e){let{components:t,...i}=e;return(0,r.kt)(u,(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"elastic-apm"},"Elastic APM"),(0,r.kt)("p",null,"Tracetest fetches traces from ",(0,r.kt)("a",{parentName:"p",href:"https://discuss.elastic.co/t/what-are-ports-9200-and-9300-used-for/238578"},"Elasticsearch's default port")," ",(0,r.kt)("inlineCode",{parentName:"p"},"9200"),"."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Examples of configuring Tracetest can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubeshop/tracetest/tree/main/examples"},(0,r.kt)("inlineCode",{parentName:"a"},"examples")," folder of the Tracetest GitHub repo"),".")),(0,r.kt)("h2",{id:"configure-tracetest-to-use-elastic-apm-as-a-trace-data-store"},"Configure Tracetest to Use Elastic APM as a Trace Data Store"),(0,r.kt)("p",null,"Configure Tracetest to fetch trace data from Elasticsearch."),(0,r.kt)("p",null,"Tracetest uses Elasticsearch's ",(0,r.kt)("strong",{parentName:"p"},"default port")," ",(0,r.kt)("inlineCode",{parentName:"p"},"9200")," to fetch trace data."),(0,r.kt)("p",null,"You need to know which ",(0,r.kt)("strong",{parentName:"p"},"Index name"),", ",(0,r.kt)("strong",{parentName:"p"},"Address"),", and ",(0,r.kt)("strong",{parentName:"p"},"credentials")," you are using."),(0,r.kt)("p",null,"The defaults can be:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Index name"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"traces-apm-default")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Address"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"https://es01:9200")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Username"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"elastic")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Password"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"changeme"))),(0,r.kt)("p",null,'To configure Elastic APM you will need to download the CA certificate from the Docker image and upload it to the config under "Upload CA file".'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The command to download the ",(0,r.kt)("inlineCode",{parentName:"li"},"ca.crt")," file is:\n",(0,r.kt)("inlineCode",{parentName:"li"},"docker cp tracetest-elasticapm-with-elastic-agent-es01-1:/usr/share/elasticsearch/config/certs/ca/ca.crt .")),(0,r.kt)("li",{parentName:"ul"},"Alternatively, you can skip CA certificate validation by setting the ",(0,r.kt)("inlineCode",{parentName:"li"},"Enable TLS but don't verify the certificate")," option.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Need help configuring the OpenTelemetry Collector so send trace data from your application to Elastic? Read more in ",(0,r.kt)("a",{parentName:"p",href:"../opentelemetry-collector-configuration-file-reference"},"the reference page here"),".")),(0,r.kt)("h2",{id:"connect-tracetest-to-elastic-with-the-web-ui"},"Connect Tracetest to Elastic with the Web UI"),(0,r.kt)("p",null,"In the Web UI, (1) open Settings and, on the (2) Configure Data Store tab, select (3) Elastic APM. If you are using Docker, as in the screenshot below, use the service name as the hostname with port ",(0,r.kt)("inlineCode",{parentName:"p"},"9200"),". Use ",(0,r.kt)("inlineCode",{parentName:"p"},"http"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"https")," if TLS is enabled."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://es01:9200\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ElasticAPM",src:a(35699).Z,width:"2842",height:"1462"})),(0,r.kt)("h2",{id:"connect-tracetest-to-elastic-with-the-cli"},"Connect Tracetest to Elastic with the CLI"),(0,r.kt)("p",null,"Or, if you prefer using the CLI, you can use this file config."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"type: DataStore\nspec:\n  name: Elastic Data Store\n  type: elasticapm\n  default: true\n  elasticapm:\n    addresses:\n      - https://es01:9200\n    username: elastic\n    password: changeme\n    index: traces-apm-default\n    insecureSkipVerify: true\n")),(0,r.kt)("p",null,"Proceed to run this command in the terminal and specify the file above."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"tracetest apply datastore -f my/data-store/file/location.yaml\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"To learn more, ",(0,r.kt)("a",{parentName:"p",href:"/examples-tutorials/recipes/running-tracetest-with-elasticapm"},"read the recipe on running a sample app with Elastic APM and Tracetest"),".")))}m.isMDXComponent=!0},35699:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ElasticAPM-settings-02a5cb5d2edf87c9069f0783ec3ec242.png"}}]);